# Format String exploits


```console
$ lldb -- ./formatstring
(lldb) br s -n main
(lldb) r
(lldb) memory read -f x -c 9 -s 8 '$rsp - 64'
0x7fffffffd090: 0x00000000000000c2 0x00007fffffffd0c7
0x7fffffffd0a0: 0x00007fffffffd0c6 0x00007ffff7e86545
0x7fffffffd0b0: 0x0000000000000000 0x000000000040120d
0x7fffffffd0c0: 0x0000000000000000 0x0000000000000000
0x7fffffffd0d0: 0x00007fffffffd1d8
```
So we are looking at the stack from $rsp - 64 and then printing the memory
from that location up to rsp. This is looking forward:
```console
        +-------------------------------------+
rsp --> |0x7fffffffd0d0 (140737488343248)     |
        +-------------------------------------+
        |0x7fffffffd0c0 (140737488343232)     |
        +-------------------------------------+
        |0x7fffffffd0b0 (140737488343216)     |
        +-------------------------------------+
        |0x7fffffffd0a0 (140737488343200)     |
        +-------------------------------------+
        |0x7fffffffd090 (140737488343184)     |
        +-------------------------------------+
```
And if we want is to look back up the stack we can use:
```console
(lldb) memory read -f x -c 17 -s 4 '$rsp'
0x7fffffffd0d0: 0xffffd1d8 0x00007fff 0x00401050 0x00000001
0x7fffffffd0e0: 0xffffd1d0 0x00007fff 0x00000000 0x00000000
0x7fffffffd0f0: 0x004011c0 0x00000000 0xf7e031a3 0x00007fff
0x7fffffffd100: 0x00000000 0x00000000 0xffffd1d8 0x00007fff
0x7fffffffd110: 0x00040000
```
Notice that we now start with the current stack pointer which comes first,
followed by the entries that were placed there by the calling function.

```c
  char c[10] = {1,2,3,4,5,6,7,8,9};
  printf("aaaaaaaaaaaaaaaaaaaaaaa %016x %016x %016x %016x\n"); 
```
So I want to figure out how many `%016x`s I need to add to get to see my
a get printed out.

One way is to look at the assembly in lldb and see how much space is getting
reserved on the stack:
```console
lldb) disassemble 
formatstring`main:
    0x401136 <+0>:   push   rbp
    0x401137 <+1>:   mov    rbp, rsp
    0x40113a <+4>:   sub    rsp, 0x30
```
And rember that the value is in hex so we can get the decimal value by:
```console
(lldb) expr -f d --   0x30
(int) $7 = 48
```
And we can then look at 
```console
0x40114f <+25>:  mov    qword ptr [rbp - 0x8], 0x40202a
```
So this is moving the value stored at 0x40202a:
```console
(lldb) memory read -f s 0x40202a
0x0040202a: "bajja"
```
into first 8 bytes of the stack for this function, so the address is -8 and
the the content will fill that entry and the rest up to rbp.

Then we have have nr that we pass a reference to printf.
```console
0x401157 <+33>:  lea    rdx, [rbp - 0xc]
```
And this will be stored as rbp-12, and it takes 4 bytes.

Next we have our `c` array:
```console
0x4011a3 <+109>: movabs rax, 0x807060504030201
0x4011ad <+119>: mov    qword ptr [rbp - 0x16], rax
0x4011b1 <+123>: mov    word ptr [rbp - 0xe], 0x9
```
Notice that the the first 8 entries in the array are added to rax. Then the
this is moved onto the stack at rbp-22. The last value is then moved into
rbp-14.
We have to remember that this above is using the base frame pointer (rbp) but
what we are interested is the stack which is pointed to by rsp.
```console
(lldb) expr -f x --  $rbp - $rsp
(unsigned long) $14 = 0x0000000000000030
(lldb) expr -f d --  $rbp - $rsp
(unsigned long) $15 = 48
```
And this is pretty much what we saw at the beginning where we subtracted 48 from
rsp. So we have to take that into account when trying to figure out how many
values (`%016x`) we need to enter.

In total we have 22 bytes below rbp with data, and rsp is at position 48 so
we have 26 bytes from 48 to get to 22. But we also want to show our value
so we probably have to add 26+10=36 %16x

Now x is a number that should be printed, so I'm thinking that it would be 4
bytes and we also have to take into account the format string itself which will
be the topmost entry on the stack. 

Just remember that what is printed is the content of memory addresses. The first
entry on the stack will be the format string itself which is a pointer to a
string.


```
  char c[10] = {1,2,3,4,5,6,7,8,9};
  printf("aaaaaaaaaaaaaaaaaaaaaaa %016x %016x %016x %016x %016x\n"); 
```
Notice that the format string will be passed to printf in the edi register:
```console
->  0x4011a3 <+109>: movabs rax, 0x807060504030201
    0x4011ad <+119>: mov    qword ptr [rbp - 0x16], rax
    0x4011b1 <+123>: mov    word ptr [rbp - 0xe], 0x9
    0x4011b7 <+129>: mov    edi, 0x4020a0
    0x4011bc <+134>: mov    eax, 0x0
    0x4011c1 <+139>: call   0x401040                  ; symbol stub for: printf
```

If we disassemble printf we can see the following:
```console
libc.so.6`.annobin_printf.c:
    0x7ffff7e33cb0 <+0>:   endbr64 
    0x7ffff7e33cb4 <+4>:   sub    rsp, 0xd8
    0x7ffff7e33cbb <+11>:  mov    r10, rdi
    0x7ffff7e33cbe <+14>:  mov    qword ptr [rsp + 0x28], rsi
    0x7ffff7e33cc3 <+19>:  mov    qword ptr [rsp + 0x30], rdx
    0x7ffff7e33cc8 <+24>:  mov    qword ptr [rsp + 0x38], rcx
    0x7ffff7e33ccd <+29>:  mov    qword ptr [rsp + 0x40], r8
    0x7ffff7e33cd2 <+34>:  mov    qword ptr [rsp + 0x48], r9
```

Before the call we call we can see the following values in these registers:
```console
(lldb) register read rsi rdx rcx r8 r9
     rsi = 0x00000000004052a0
     rdx = 0x0000000000000000
     rcx = 0x0000000000000000
      r8 = 0x0000000000000000
      r9 = 0x0000000000000030
```
And notice the output:
```console
(lldb) n
aaaaaaaaaaaaaaaaaaaaaaa 00000000004052a0 0000000000000000 0000000000000000 0000000000000000 0000000000000030
```
So we can see that printf will first take those values and add them to the
stack. Normally, when parameter are passed in addition to the format string
there registers would used for those value (I think).

So, if we add one more `%016x` we should see what is currently at the top of
the stack:
```
(lldb) n
aaaaaaaaaaaaaaaaaaaaaaa 00000000004052a0 0000000000000000 0000000000000000 0000000000000000 0000000000000030 00000000ffffd1d8
(lldb) memory read -f x -c 1 -s 8 '$rsp'
0x7fffffffd0c0: 0x00007fffffffd1d8
```
So on x64 we will need to take into account the register values that are placed
onto the stack before we can start reading data from the stack.

When we read values off the stack we are only interested in values that are
located behind the current stack pointer (rsp + #).
These are values that have been placed there by ealier code. Anything infront
of the stack pointer is just garbage (unless values have been placed there
without the interaction of the stackpointer which is possible). Also remember
that if we go back far enough we will eventually come across the value that the
that the `call` instruction pushed onto the stack, which will be used by the ret
instruction to pop into the instruction pointer register (rip). So if we can
find the value, by going backwards (rsp+#) and overwrite that value we could get
the program to jump there. But how do we go about overwriting?


So lets use step-inst to step into the printf function:
```console
->  0x4011c1 <+139>: call   0x401040                  ; symbol stub for: printf
    0x4011c6 <+144>: mov    edi, 0x4020a0
(lldb) thread step-inst
```
Now if we check the top most value on the stack we find:
```console
(lldb) memory read -f x -c 1 -s 8 '$rsp'
0x7fffffffd0b8: 0x00000000004011c6
```
Which is the next instruction in our `main` function. With that information we
can try to see if we can get our program to print this value for us. If we
recall or just disassemble we can see that 216 is subtracted from rsp.
Would it work if we just use 216, lets try:
```console
libc.so.6`.annobin_printf.c:
->  0x7ffff7e33cb0 <+0>:   endbr64 
    0x7ffff7e33cb4 <+4>:   sub    rsp, 0xd8
```
After the `sub` instruction we can:
```console
(lldb) memory read -f x -c 1 -s 8 '$rsp + 216'
0x7fffffffd0b8: 0x00000000004011c6
```
But we will call `__vfprintf_internal`:
```console
libc.so.6`.annobin_printf.c:
->  0x7ffff7e33d5a <+170>: call   0x7ffff7e471d0            ; __vfprintf_internal
```
So before this call we can see that we can access our original return value:
```console
(lldb) memory read -f x -c 1 -s 8 '$rsp + 216'
0x7fffffffd0b8: 0x00000000004011c6
```
which means that another value will be pushed onto the stack:
```console
(lldb) memory read -f x -c 1 -s 8 '$rsp + 216 + 8'
0x7fffffffd0b8: 0x00000000004011c6
```
After this we have:
```console
    0x7ffff7e471d4 <+4>:     push   rbp                      -8
    0x7ffff7e471d5 <+5>:     mov    rbp, rsp
->  0x7ffff7e471d8 <+8>:     push   r15                      -8
    0x7ffff7e471da <+10>:    push   r14                      -8
    0x7ffff7e471dc <+12>:    mov    r14, rdx
    0x7ffff7e471df <+15>:    push   r13                      -8
    0x7ffff7e471e1 <+17>:    mov    r13, rsi
    0x7ffff7e471e4 <+20>:    push   r12                      -8
    0x7ffff7e471e6 <+22>:    mov    r12, rdi
    0x7ffff7e471e9 <+25>:    push   rbx                      -8
    0x7ffff7e471ea <+26>:    sub    rsp, 0x538

(lldb) expr 6 * 8
(int) $17 = 48
(lldb) expr -f d -- 0x538
(int) $19 = 1336
```
And from within `__vfprintf_internal` we can access our original return value
as well:
```console
(lldb) memory read -f x -c 1 -s 8 '$rsp + 216 + 8 + 48 + 1336
0x7fffffffd0b8: 0x00000000004011c6

(lldb) expr 216 + 8 + 48 + 1336
(int) $35 = 1608

(lldb) memory read -f x -c 1 -s 8 '$rsp + 1608'
0x7fffffffd0b8: 0x00000000004011c6
```
So, what we would like is to disply this value in our formatstring output.

%x means show a hexadecimal `unsigned int` which is of size 4. When we specify
%0x we are telling printf to display as a 8-digit padded hexadecimal number.

Now when we specify %#$016x the number we specify is the position of
the argument (there are now but if there were this would be it). So if we
want to display the return address above what number should this be. If each
argument corresponds to an entry on the stack, and each entry is 8 bytes we
should take 1608 / 64 = 25. So what woud give us 25 arguments that are on the
stack before the one we are intersted in? 

0x7fffffffd0b8: 0x00000000004011c6

0x7fffffffd0b8:     0x00000000004011c6
b8 0d ff ff ff 7f   c6 11 40


Just a note about decrementing rsp by one is just that, subtracting one from a

value. If we want to figure out how many slots of 4 bytes (32-bits), 8 bytes
(64-bits) we need to divide by the number of bits. push will decrement rsp
by 8 (8*8=64).


So lets take rsp which we know grows down wards so we should be able to take
our address that we know is further up on the stack and subtract it with
the current value of rsp

```
(lldb) memory read -f x -c 1 -s 8 '$rsp'
0x7fffffffca70: 0x00000000156b2bb8
```

So reading from rsp and 202 8 bytes values will produce:
```
(lldb) memory read --force -f x -c 202 -s 8 '$rsp'
0x7fffffffca70: 0x00000000156b2bb8 0x0000000000000027
0x7fffffffca80: 0x0000000000000001 0x0000000000000000
0x7fffffffca90: 0x0000000000000000 0x00007fff00000000
0x7fffffffcaa0: 0xffffffffffffffff 0x0000000100000001
0x7fffffffcab0: 0x00007fff00000000 0x00007fff00000027
0x7fffffffcac0: 0x0000000000000000 0x00007fff00000029
0x7fffffffcad0: 0x0000000000000006 0x0000000000000006
0x7fffffffcae0: 0x000000000000002f 0x0000000000000000
0x7fffffffcaf0: 0x00007ffff7f9f700 0x0000000000000d68
0x7fffffffcb00: 0x0000000000402097 0x0000000000000000
0x7fffffffcb10: 0x00007ffff7fa5520 0x000000000040209a
0x7fffffffcb20: 0x0000000000400358 0x00007fffffffcc00
0x7fffffffcb30: 0x0000000000000003 0x00007ffff7fcf2d8
0x7fffffffcb40: 0x00000000f7ffe700 0x0000000000000000
0x7fffffffcb50: 0x00007fffffffcbd4 0x00000000156b2bb8
0x7fffffffcb60: 0x00007ffff7e35070 0x00007ffff7f9f500
0x7fffffffcb70: 0x00007fffffffcca8 0x00007fffffffcc00
0x7fffffffcb80: 0x00007fffffffcc10 0x0000003000000008
0x7fffffffcb90: 0x00007fffffffd0c0 0x00007fffffffd000
0x7fffffffcba0: 0x0000000000000001 0x0000000000000000
0x7fffffffcbb0: 0x0000000000000001 0x00007ffff7ffe150
0x7fffffffcbc0: 0x00007fffffffcc44 0x00007ffff7fa5570
0x7fffffffcbd0: 0x00007ffff7ffe150 0x00007ffff7ffe4b8
0x7fffffffcbe0: 0x0000000000000000 0x00007ffff7de3558
0x7fffffffcbf0: 0x00007ffff7fd192f 0x0000000000000001
0x7fffffffcc00: 0x00000000ffffffff 0x00007fffffffcc44
0x7fffffffcc10: 0x00007ffff7de7110 0x00007ffff7fa5000
0x7fffffffcc20: 0x00007ffff7fd15a0 0x00007fffffffcd00
0x7fffffffcc30: 0x0000000000000003 0x0000000000000000
0x7fffffffcc40: 0x0000000000000000 0x0000000000000000
0x7fffffffcc50: 0x0000000000000000 0x0000000000404020
0x7fffffffcc60: 0x00007fffffffd0f0 0x0000000000401050
0x7fffffffcc70: 0x00007fffffffd1d0 0x0000000000000000
0x7fffffffcc80: 0x0000000000000000 0x00007ffff7fe16c7
0x7fffffffcc90: 0x0000000000000001 0x0000000000000000
0x7fffffffcca0: 0x0000000000000009 0x00007ffff7de7110
0x7fffffffccb0: 0x00007fffffffd0a0 0x00007ffff7fe878e
0x7fffffffccc0: 0x0000000000000000 0x00007ffff7ece4a7
0x7fffffffccd0: 0x00007fffffffd0e4 0x000000000040202a
0x7fffffffcce0: 0x0000000000402030 0x000000000000001a
0x7fffffffccf0: 0x0000000000000040 0x00007fff00000001
0x7fffffffcd00: 0x00000000ffffffff 0x00007ffff7f9dbb0
0x7fffffffcd10: 0x00007ffff7df1220 0x0000ffff00001f80
0x7fffffffcd20: 0x0000000000000000 0x0000000000000000
0x7fffffffcd30: 0x0000000000000000 0x00007ffff7fcf1e8
0x7fffffffcd40: 0x0000002000000000 0x0000000000000000
0x7fffffffcd50: 0x0000000000000000 0x00007ffff7fd2000
0x7fffffffcd60: 0x00007fffffffcea0 0x0000000000000007
0x7fffffffcd70: 0x0000000900000007 0x00007ffff7fd15a0
0x7fffffffcd80: 0x00007ffff7ffd988 0x00007ffff7fde1c8
0x7fffffffcd90: 0x0000000000000000 0x00007ffff7ed4317
0x7fffffffcda0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdb0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdc0: 0x0000000000000000 0x000000ff00000000
0x7fffffffcdd0: 0x0000000000000000 0x0000000000000000
0x7fffffffcde0: 0x2f2f2f2f2f2f2f2f 0x2f2f2f2f2f2f2f2f
0x7fffffffcdf0: 0x0000000000000000 0x0000000000000000
0x7fffffffce00: 0x0000000000000000 0x0000000000000000
0x7fffffffce10: 0x0000000000000000 0x0000000000000000
0x7fffffffce20: 0x0000000000000000 0x0000000000000000
0x7fffffffce30: 0x0000000000000000 0x0000000000000000
0x7fffffffce40: 0x0000000000000000 0x0000000000000000
0x7fffffffce50: 0x0000000000000000 0x0000000000000000
0x7fffffffce60: 0x0000000000000000 0x0000000000000000
0x7fffffffce70: 0x0000000000000000 0x0000000000000000
0x7fffffffce80: 0x0000000000000000 0x0000000000000000
0x7fffffffce90: 0x0000000000000000 0x0000000000000000
0x7fffffffcea0: 0x00007ffff7df1370 0x000000000000000a
0x7fffffffceb0: 0x0000003a00000029 0x0000000000000010
0x7fffffffcec0: 0x0000004000000041 0x0000000000000000
0x7fffffffced0: 0x0000000000000000 0x0000000000000002
0x7fffffffcee0: 0x000000770000007c 0x0000005d0000006e
0x7fffffffcef0: 0x00007ffff7f9e9e0 0x000000000000003f
0x7fffffffcf00: 0x0000000000000002 0x800000000000000e
0x7fffffffcf10: 0x0000000000000000 0x0000000000000000
0x7fffffffcf20: 0x0000000000000000 0x0000000000000000
0x7fffffffcf30: 0x0000000000000000 0x0000000000000000
0x7fffffffcf40: 0x00007ffff7fa0300 0x00007ffff7e51d9d
0x7fffffffcf50: 0x0000000000000018 0x0000000000000021
0x7fffffffcf60: 0x0000000000000001 0x000003e800002190
0x7fffffffcf70: 0x0000000000000005 0x000000000000881e
0x7fffffffcf80: 0x0000000000000000 0x0000000000000400
0x7fffffffcf90: 0x3061323530340000 0x8b6f9c9ed9359c00
0x7fffffffcfa0: 0x0000000016fb880e 0x0000000000000000
0x7fffffffcfb0: 0x0000000000401050 0x00007fffffffd1d0
0x7fffffffcfc0: 0x0000000000000000 0x0000000000000000
0x7fffffffcfd0: 0x00007fffffffd0f0 0x00007ffff7e33d5f
0x7fffffffcfe0: 0x0000003000000008 0x00007fffffffd0c0
0x7fffffffcff0: 0x00007fffffffd000 0x8b6f9c9ed9359c00
0x7fffffffd000: 0x00000000004052a0 0x00000000004052a0
0x7fffffffd010: 0x0000000000000000 0x0000000000000000
0x7fffffffd020: 0x0000000000000000 0x0000000000000030
0x7fffffffd030: 0x00007ffff7f9f500 0x0000000000402010
0x7fffffffd040: 0x00007ffff7f9f5e8 0x00007ffff7fa0300
0x7fffffffd050: 0x0000000000000000 0x00007ffff7e5f599
0x7fffffffd060: 0x000000000000000a 0x00007ffff7e5fa03
0x7fffffffd070: 0x0000000000000019 0x00007ffff7f9f500
0x7fffffffd080: 0x0000000000402010 0x00007ffff7e5443a
0x7fffffffd090: 0x0000000000000000 0x00007fffffffd0f0
0x7fffffffd0a0: 0x0000000000000000 0x00007ffff7ffe150
0x7fffffffd0b0: 0x0000000000000001 0x00000000004011c6
```
And notice the last entry which is our return address.

And when we used this we also got to the correct value:
```console
(lldb) memory read -f x -c 1 -s 8 '$rsp + 1608'
```
What is the connetion between these that I'm not getting?
```
(lldb) memory read -f x -c 1 -s 8 '$rsp + 1608'
(lldb) memory read --force -f x -c 202 -s 8 '$rsp'
```
Well 202 * 8 = 1616
```
(lldb) memory read --force -f x -c 202 -s 8 '$rsp'
0x7fffffffca80: 0x00007ffff7fa5000 0x0000000000400358
0x7fffffffca90: 0x00007ffff7de1a48 0x0000000000000000
0x7fffffffcaa0: 0x0000000000000000 0x00007fff00000000
0x7fffffffcab0: 0xffffffffffffffff 0x0000000100000000
0x7fffffffcac0: 0x00007fff00000000 0x000000000000001a
0x7fffffffcad0: 0x0000000000000000 0x00000000004052a0
0x7fffffffcae0: 0x00007fff00000000 0x00007fff0000001a
0x7fffffffcaf0: 0x0000000000000034 0x0000000000000000
0x7fffffffcb00: 0x00007ffff7f9f700 0x0000000000000d68
0x7fffffffcb10: 0x0000000000402044 0x0000000000000000
0x7fffffffcb20: 0x0000000000400358 0x0000000000402047
0x7fffffffcb30: 0x0000000000000003 0x00007ffff7fcf2d8
0x7fffffffcb40: 0x00000000f7ffe700 0x0000000000000000
0x7fffffffcb50: 0x00007fffffffcbd4 0x00000000156b2bb8
0x7fffffffcb60: 0x00007ffff7ffe4b8 0x00000000004003b0
0x7fffffffcb70: 0x00007ffff7e35070 0x00007ffff7f9f500
0x7fffffffcb80: 0x00007fffffffcc10 0x00007ffff7fdccc1
0x7fffffffcb90: 0x0000000000000001 0x0000003000000008
0x7fffffffcba0: 0x00007fffffffd0d0 0x00007fffffffd010
0x7fffffffcbb0: 0x0000000000000001 0x00007ffff7ffe150
0x7fffffffcbc0: 0x00007fffffffcc44 0x00007ffff7fa5570
0x7fffffffcbd0: 0x00007ffff7ffe150 0x00007ffff7ffe4b8
0x7fffffffcbe0: 0x0000000000000000 0x00007ffff7de3558
0x7fffffffcbf0: 0x00007ffff7fd192f 0x0000000000000001
0x7fffffffcc00: 0x00000000ffffffff 0x00007fffffffcc44
0x7fffffffcc10: 0x00007ffff7de7110 0x00007ffff7fa5000
0x7fffffffcc20: 0x00007ffff7fd15a0 0x00007fffffffcd00
0x7fffffffcc30: 0x0000000000000003 0x0000000000000000
0x7fffffffcc40: 0x0000000000000000 0x0000000000000000
0x7fffffffcc50: 0x0000000000000000 0x0000000000404020
0x7fffffffcc60: 0x00007fffffffd0f0 0x0000000000401050
0x7fffffffcc70: 0x00007fffffffd1d0 0x0000000000000000 
0x7fffffffcc80: 0x0000000000000000 0x00007ffff7fe16c7
0x7fffffffcc90: 0x0000000000000001 0x0000000000000000
0x7fffffffcca0: 0x0000000000000009 0x00007ffff7de7110
0x7fffffffccb0: 0x00007fffffffd0b0 0x00007ffff7fe878e
0x7fffffffccc0: 0x0000000000000000 0x00007ffff7ece4a7
0x7fffffffccd0: 0x0000000000000000 0x00000000004052a0
0x7fffffffcce0: 0x000000000040202a 0x000000000000001a
0x7fffffffccf0: 0x0000000000000040 0x00007fff00000001
0x7fffffffcd00: 0x00000000ffffffff 0x00007ffff7f9dbb0
0x7fffffffcd10: 0x00007ffff7df1220 0x0000ffff00001f80
0x7fffffffcd20: 0x0000000000000000 0x0000000000000000
0x7fffffffcd30: 0x0000000000000000 0x00007ffff7fcf1e8
0x7fffffffcd40: 0x0000002000000000 0x0000000000000000
0x7fffffffcd50: 0x0000000000000000 0x00007ffff7fd2000
0x7fffffffcd60: 0x00007fffffffcea0 0x0000000000000007
0x7fffffffcd70: 0x0000000900000007 0x00007ffff7fd15a0
0x7fffffffcd80: 0x00007ffff7ffd988 0x00007ffff7fde1c8
0x7fffffffcd90: 0x0000000000000000 0x00007ffff7fdefe8
0x7fffffffcda0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdb0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdc0: 0x0000000000000000 0x000000ff00000000
0x7fffffffcdd0: 0x0000000000000000 0x0000000000000000
0x7fffffffcde0: 0x2f2f2f2f2f2f2f2f 0x2f2f2f2f2f2f2f2f
0x7fffffffcdf0: 0x0000000000000000 0x0000000000000000
0x7fffffffce00: 0x0000000000000000 0x0000000000000000
0x7fffffffce10: 0x0000000000000000 0x0000000000000000
0x7fffffffce20: 0x0000000000000000 0x0000000000000000
0x7fffffffce30: 0x0000000000000000 0x0000000000000000
0x7fffffffce40: 0x0000000000000000 0x0000000000000000
0x7fffffffce50: 0x0000000000000000 0x0000000000000000
0x7fffffffce60: 0x0000000000000000 0x0000000000000000
0x7fffffffce70: 0x0000000000000000 0x0000000000000000
0x7fffffffce80: 0x0000000000000000 0x0000000000000000
0x7fffffffce90: 0x0000000000000000 0x0000000000000000
0x7fffffffcea0: 0x0000000000000410 0x0000000000000400
0x7fffffffceb0: 0x00007ffff7df1370 0x000000000000000a
0x7fffffffcec0: 0x0000003a00000029 0x0000000000000010
0x7fffffffced0: 0x0000004000000041 0x0000000000000000
0x7fffffffcee0: 0x0000000000000000 0x0000000000000002
0x7fffffffcef0: 0x000000770000007c 0x0000005d0000006e
0x7fffffffcf00: 0x0000000000000002 0x800000000000000e
0x7fffffffcf10: 0x0000000000000000 0x0000000000000000
0x7fffffffcf20: 0x0000000000000000 0x0000000000000000
0x7fffffffcf30: 0x0000000000000000 0x0000000000000000
0x7fffffffcf40: 0x00007ffff7f9f500 0x0000000000402010
0x7fffffffcf50: 0x00007ffff7fa0300 0x00007ffff7e51d9d
0x7fffffffcf60: 0x0000000000000018 0x0000000000000021
0x7fffffffcf70: 0x0000000000000001 0x000003e800002190
0x7fffffffcf80: 0x0000000000000005 0x000000000000881e
0x7fffffffcf90: 0x0000000000000000 0x0000000000000400
0x7fffffffcfa0: 0x0000000000000000 0x6484b3669c431900
0x7fffffffcfb0: 0x0000000036ac9311 0x0000000000000000
0x7fffffffcfc0: 0x0000000000401050 0x00007fffffffd1d0
0x7fffffffcfd0: 0x0000000000000000 0x0000000000000000
0x7fffffffcfe0: 0x00007fffffffd0f0 0x00007ffff7e33d5f
0x7fffffffcff0: 0x0000003000000008 0x00007fffffffd0d0
0x7fffffffd000: 0x00007fffffffd010 0x6484b3669c431900
0x7fffffffd010: 0x00000000004052a0 0x00000000004052a0
0x7fffffffd020: 0x0000000000000000 0x0000000000000000
0x7fffffffd030: 0x00000000ffffffff 0x0000000000000035
0x7fffffffd040: 0x00007ffff7f9f500 0x0000000000402010
0x7fffffffd050: 0x00007ffff7f9f5e8 0x00007ffff7fa0300
0x7fffffffd060: 0x0000000000000000 0x00007ffff7e5f599
0x7fffffffd070: 0x000000000000000a 0x00007ffff7e5fa03
0x7fffffffd080: 0x0000000000000019 0x00007ffff7f9f500
0x7fffffffd090: 0x0000000000402010 0x00007ffff7e5443a
0x7fffffffd0a0: 0x0000000000000000 0x00007fffffffd0f0
0x7fffffffd0b0: 0x0000000000000000 0x00007ffff7ffe150
0x7fffffffd0c0: 0x0000000000000001 0x0000000000401181
```

I'm looking for the return address 0x0000000000401181 remember that!
I've been thinking about this the wrong way. When the stack is decremented the
values that I'm interested in seeing in the output are not being
displayed as they are further up the stack. 

```console
(lldb) memory read --force -f x -c 220 -s 8 '$rsp'
0x7fffffffca80: 0x0000006df7fa5000 0x000000000000006d
0x7fffffffca90: 0x0000000000000001 0x0000000000000000
0x7fffffffcaa0: 0x0000000000000000 0x00007fff00000000
0x7fffffffcab0: 0xffffffffffffffff 0x0000000600000001
0x7fffffffcac0: 0x00007fff00000000 0x00007fff0000006d
0x7fffffffcad0: 0x00007fff0000006f 0x00007fff00000071
0x7fffffffcae0: 0x00007fff0000000c 0x000000000000000c
0x7fffffffcaf0: 0x000000000000007d 0x0000000000000000
0x7fffffffcb00: 0x00007ffff7f9f700 0x0000000000000d68
0x7fffffffcb10: 0x0000000000402060 0x0000000000000000
0x7fffffffcb20: 0x0000000000400358 0x0000000000402084
0x7fffffffcb30: 0x0000000000000003 0x00007ffff7fcf2d8
0x7fffffffcb40: 0x00000000f7ffe700 0x0000000000000000
0x7fffffffcb50: 0x00007fffffffcbd4 0x00000000156b2bb8
0x7fffffffcb60: 0x00007ffff7ffe4b8 0x00000000004003b0
0x7fffffffcb70: 0x00007ffff7e35070 0x00007ffff7f9f500
0x7fffffffcb80: 0x00007fffffffcc10 0x00007ffff7fdccc1
0x7fffffffcb90: 0x0000000000000001 0x0000003000000008
0x7fffffffcba0: 0x00007fffffffd0d0 0x00007fffffffd010
0x7fffffffcbb0: 0x0000000000000001 0x00007ffff7ffe150
0x7fffffffcbc0: 0x00007fffffffcc44 0x00007ffff7fa5570
0x7fffffffcbd0: 0x00007ffff7ffe150 0x00007ffff7ffe4b8
0x7fffffffcbe0: 0x0000000000000000 0x00007ffff7de3558
0x7fffffffcbf0: 0x00007ffff7fd192f 0x0000000000000001
0x7fffffffcc00: 0x00000000ffffffff 0x00007fffffffcc44
0x7fffffffcc10: 0x00007ffff7de7110 0x00007ffff7fa5000
0x7fffffffcc20: 0x00007ffff7fd15a0 0x00007fffffffcd00
0x7fffffffcc30: 0x0000000000000003 0x0000000000000000
0x7fffffffcc40: 0x0000000000000000 0x0000000000000000
0x7fffffffcc50: 0x0000000000000000 0x0000000000404020
0x7fffffffcc60: 0x00007fffffffd0f0 0x0000000000401050
0x7fffffffcc70: 0x00007fffffffd1d0 0x0000000000000000
0x7fffffffcc80: 0x0000000000000000 0x00007ffff7fe16c7
0x7fffffffcc90: 0x0000000000000001 0x0000000000000000
0x7fffffffcca0: 0x0000000000000009 0x00007ffff7de7110
0x7fffffffccb0: 0x00007fffffffd0b0 0x00007ffff7fe878e
0x7fffffffccc0: 0x0000000000000000 0x00007ffff7ece4a7
0x7fffffffccd0: 0x0000000000000000 0x00000000004052a0
0x7fffffffcce0: 0x000000000040202a 0x000000000000001a
0x7fffffffccf0: 0x0000000000000040 0x00007fff00000001
0x7fffffffcd00: 0x00000000ffffffff 0x00007ffff7f9dbb0
0x7fffffffcd10: 0x00007ffff7df1220 0x0000ffff00001f80
0x7fffffffcd20: 0x0000000000000000 0x0000000000000000
0x7fffffffcd30: 0x0000000000000000 0x00007ffff7fcf1e8
0x7fffffffcd40: 0x0000002000000000 0x0000000000000000
0x7fffffffcd50: 0x0000000000000000 0x00007ffff7fd2000
0x7fffffffcd60: 0x00007fffffffcea0 0x0000000000000007
0x7fffffffcd70: 0x0000000900000007 0x00007ffff7fd15a0
0x7fffffffcd80: 0x00007ffff7ffd988 0x00007ffff7fde1c8
0x7fffffffcd90: 0x0000000000000000 0x00007ffff7fdefe8
0x7fffffffcda0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdb0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdc0: 0x0000000000000000 0x000000ff00000000
0x7fffffffcdd0: 0x0000000000000000 0x0000000000000000
0x7fffffffcde0: 0x2f2f2f2f2f2f2f2f 0x2f2f2f2f2f2f2f2f
0x7fffffffcdf0: 0x0000000000000000 0x0000000000000000
0x7fffffffce00: 0x0000000000000000 0x0000000000000000
0x7fffffffce10: 0x0000000000000000 0x0000000000000000
0x7fffffffce20: 0x0000000000000000 0x0000000000000000
0x7fffffffce30: 0x0000000000000000 0x0000000000000000
0x7fffffffce40: 0x0000000000000000 0x0000000000000000
0x7fffffffce50: 0x0000000000000000 0x0000000000000000
0x7fffffffce60: 0x0000000000000000 0x0000000000000000
0x7fffffffce70: 0x0000000000000000 0x0000000000000000
0x7fffffffce80: 0x0000000000000000 0x0000000000000000
0x7fffffffce90: 0x0000000000000000 0x0000000000000000
0x7fffffffcea0: 0x0000000000000410 0x0000000000000400
0x7fffffffceb0: 0x00007ffff7df1370 0x000000000000000a
0x7fffffffcec0: 0x0000003a00000029 0x0000000000000010
0x7fffffffced0: 0x0000004000000041 0x0000000000000000
0x7fffffffcee0: 0x0000000000000000 0x0000000000000002
0x7fffffffcef0: 0x000000770000007c 0x0000005d0000006e
0x7fffffffcf00: 0x0000000000000002 0x800000000000000e
0x7fffffffcf10: 0x0000000000000000 0x0000000000000000
0x7fffffffcf20: 0x0000000000000000 0x0000000000000000
0x7fffffffcf30: 0x0000000000000000 0x0000000000000000
0x7fffffffcf40: 0x00007ffff7f9f500 0x0000000000402010
0x7fffffffcf50: 0x00007ffff7fa0300 0x00007ffff7e51d9d
0x7fffffffcf60: 0x0000000000000018 0x0000000000000021
0x7fffffffcf70: 0x0000000000000001 0x000003e800002190
0x7fffffffcf80: 0x0000000000000005 0x000000000000881e
0x7fffffffcf90: 0x0000000000000000 0x6666663700000400
0x7fffffffcfa0: 0x3864316466666666 0x0d9f2148f0db0e00
0x7fffffffcfb0: 0x000000000784a42a 0x0000000000000000
0x7fffffffcfc0: 0x0000000000401050 0x00007fffffffd1d0
0x7fffffffcfd0: 0x0000000000000000 0x0000000000000000
0x7fffffffcfe0: 0x00007fffffffd0f0 0x00007ffff7e33d5f
0x7fffffffcff0: 0x0000003000000008 0x00007fffffffd0d0
0x7fffffffd000: 0x00007fffffffd010 0x0d9f2148f0db0e00
0x7fffffffd010: 0x00000000004052a0 0x00000000004052a0
0x7fffffffd020: 0x0000000000000000 0x0000000000000000
0x7fffffffd030: 0x0000000000000000 0x000000000000007e
0x7fffffffd040: 0x00007ffff7f9f500 0x0000000000402010
0x7fffffffd050: 0x00007ffff7f9f5e8 0x00007ffff7fa0300
0x7fffffffd060: 0x0000000000000000 0x00007ffff7e5f599
0x7fffffffd070: 0x000000000000000a 0x00007ffff7e5fa03
0x7fffffffd080: 0x0000000000000019 0x00007ffff7f9f500
0x7fffffffd090: 0x0000000000402010 0x00007ffff7e5443a
0x7fffffffd0a0: 0x0000000000000000 0x00007fffffffd0f0
0x7fffffffd0b0: 0x0000000000000000 0x00007ffff7ffe150
0x7fffffffd0c0: 0x0000000000000001 0x0000000000401190

0x7fffffffd0d0: 0x00007fffffffd1d8 0x0000000100401050 <-- parameter nr 6
0x7fffffffd0e0: 0x02017fffffffd1d0 0x0009080706050403 
0x7fffffffd0f0: 0x00000000004011b0 0x00007ffff7e031a3
0x7fffffffd100: 0x0000000000000000 0x00007fffffffd1d8
0x7fffffffd110: 0x0000000100040000 0x0000000000401136
0x7fffffffd120: 0x0000000000000000 0x09ed8f1734d3dc7e
0x7fffffffd130: 0x0000000000401050 0x00007fffffffd1d0
0x7fffffffd140: 0x0000000000000000 0x0000000000000000
0x7fffffffd150: 0xf6127068b5b3dc7e 0xf6126057751ddc7e


0x7fffffffd0c0: 0x0000000000000001 0x0000000000401190
```
and notice `0x007fffffffd1d8` that is the last value that we printed in our
output as we skipped the first 5 values since there were just the contents
for rdi, rsi, rdx, r8, and r9:
```
aaaaaaaaaaaaaaaaaaaaaaa 0x00000000d522a0            (nil)            (nil) 0x000000ffffffff 0x00000000000035 0x007ffc96566278 0x00000100401050
```
So the stack we are interrested in starts from that position, so how many
positions are there from there to our return address?

I've been thinking about this all wrong. printf will start printing from the
current value of rsp. The value I've been looking for is behind this and while
we can show the contents of the stack we can't see behind the current rsp. 
But if there is a way to write to the stack we should able to overwrite
the return address on the stack with the address of the function we want to have
called.

When the function returns `ret` will take the value at the top of the stack
which if we look at ou


0x7fffffffd0d0: 0x00007fffffffd1d8 0x0000000100401050


$ python -c "print ('\x2c\xa0\x04\x08' + '%x '*4 + '%x ')"
,%x %x %x %x %x


Below is just a manualy way of overwritint the return address on the stack
so that I can figure out how to do this:
```console
(lldb) memory read --force -f x -c 2 -s 8 '$rsp'
0x7fffffffd0a8: 0x0000000000401165 0x0000000000401050

(lldb) dis -n something
formatstring_write`something:
    0x401136 <+0>:  push   rbp
    0x401137 <+1>:  mov    rbp, rsp
    0x40113a <+4>:  mov    edi, 0x402010
    0x40113f <+9>:  call   0x401030                  ; symbol stub for: puts
    0x401144 <+14>: nop    
    0x401145 <+15>: pop    rbp
    0x401146 <+16>: ret    

(lldb) memory write -f x -s 8  0x7fffffffd0a8 0x401136
(lldb) memory read -f x -c 1 -s 8 0x7fffffffd0a8
0x7fffffffd0a8: 0x0000000000401136
```
0000000                                                                 fffffff
+-----------------------------------------------------------------------------+
|                                                                             |
+-----------------------------------------------------------------------------+


(lldb) expr &magic_key
(int *) $5 = 0x00007fffffffd0f4

   0x40117f <+89>:  call   0x401030                  ; symbol stub for: printf
   0x401184 <+94>:  mov    eax, dword ptr [rbp - 0xc]

(lldb) memory read --force -f x -c 200 -s 8 $rsp
0x7fffffffca90: 0x0000000000000000 0x0000000000000010
0x7fffffffcaa0: 0x0000000000000001 0x0000000000000000
0x7fffffffcab0: 0x0000000000000000 0x0000000000000000
0x7fffffffcac0: 0xffffffffffffffff 0x0000000100000001
0x7fffffffcad0: 0x00007fff00000000 0x00007fff00000010
0x7fffffffcae0: 0x00007fff00000000 0x00007fff00000012
0x7fffffffcaf0: 0x00007fff0000000c 0x000000000000000c
0x7fffffffcb00: 0x000000000000001e 0x0000000000000000
0x7fffffffcb10: 0x00007ffff7f9f700 0x0000000000000d68
0x7fffffffcb20: 0x0000000000402020 0x0000000000000000
0x7fffffffcb30: 0x0000000000400393 0x0000000000402023
0x7fffffffcb40: 0x000000000055acae 0x00007fffffffcb84
0x7fffffffcb50: 0x00007ffff7fa5520 0x00007fffffffcc50
0x7fffffffcb60: 0x0000000000400340 0x00007fffffffcc40
0x7fffffffcb70: 0x0000000000000003 0x00007ffff7fdbf7c
0x7fffffffcb80: 0x00007ffff7e35070 0x00007ffff7f9f500
0x7fffffffcb90: 0x00007ffff7fa5000 0x00000000156b2bb8
0x7fffffffcba0: 0x00007ffff7ffe4b8 0x0000003000000008
0x7fffffffcbb0: 0x00007fffffffd0e0 0x00007fffffffd020
0x7fffffffcbc0: 0x00007fffffffcc50 0x00007ffff7fdccc1
0x7fffffffcbd0: 0x0000000000000001 0x00007ffff7fa5570
0x7fffffffcbe0: 0x0000000000000001 0x0000000000000000
0x7fffffffcbf0: 0x0000000000000001 0x00007ffff7ffe150
0x7fffffffcc00: 0x00007ffff7fd192f 0x00007ffff7fa5570
0x7fffffffcc10: 0x00007ffff7ffe150 0x00007ffff7ffe4b8
0x7fffffffcc20: 0x0000000000000000 0x00007fffffffcd20
0x7fffffffcc30: 0x00007ffff7fd15a0 0x00007fff00000001
0x7fffffffcc40: 0x00000000ffffffff 0x0000000000000000
0x7fffffffcc50: 0x00007ffff7de7110 0x00007ffff7fa5000
0x7fffffffcc60: 0x0000000000000000 0x000000007c96f087
0x7fffffffcc70: 0x00007ffff7ffe4b8 0x00007ffff7fd192f
0x7fffffffcc80: 0x00007fffffffce38 0x00007fffffffcd10
0x7fffffffcc90: 0x00007fffffffcd20 0x0000000000404018
0x7fffffffcca0: 0x00007fffffffd100 0x0000000000401040
0x7fffffffccb0: 0x00007fffffffd1e0 0x0000000000000000
0x7fffffffccc0: 0x0000000000000000 0x00007ffff7fe16c7
0x7fffffffccd0: 0x0000000000000001 0x0000000000000000
0x7fffffffcce0: 0x00007ffff7ffd988 0x00007ffff7de7110
0x7fffffffccf0: 0x00007fffffffd0c0 0x00007ffff7fe878e
0x7fffffffcd00: 0x0000000000000000 0x00007ffff7f9e578

0x7fffffffcd10: 0x00007fffffffd1f8 0x00007fffffffd0f4 <--- &magic_key
0x7fffffffcd20: 0x0000000000402010 0x0000000000000000
0x7fffffffcd30: 0x00007ffff7fe2100 0x0000000000000000
0x7fffffffcd40: 0x0000000000000000 0x00007ffff7fcf1e8
0x7fffffffcd50: 0x0000002000000000 0x0000ffff00001f80
0x7fffffffcd60: 0x0000000000000000 0x00007ffff7fd2000
0x7fffffffcd70: 0x00007fffffffceb0 0x0000000000000007
0x7fffffffcd80: 0x0000000900000007 0x00007ffff7fd15a0
0x7fffffffcd90: 0x00007ffff7ffd988 0x00007ffff7fde1c8
0x7fffffffcda0: 0x0000000000000000 0x00007ffff7fdefe8
0x7fffffffcdb0: 0x00007fffffffce00 0x00007ffff7df8b18
0x7fffffffcdc0: 0x0000000000004673 0x0000000000000000
0x7fffffffcdd0: 0x00007fffffffce80 0x0000000000000000
0x7fffffffcde0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdf0: 0x766f2f7374696f6c 0x0065746972777265
0x7fffffffce00: 0x0000000000000000 0xff00000000000000
0x7fffffffce10: 0x0000ff0000000000 0x0000000000000000
0x7fffffffce20: 0x2f2f2f2f2f2f2f2f 0x2f2f2f2f2f2f2f2f
0x7fffffffce30: 0x0000000000000000 0x0000000000000000
0x7fffffffce40: 0x0000000000000000 0x0000000000000000
0x7fffffffce50: 0x0000000000000000 0x0000000000000000
0x7fffffffce60: 0x0000000000000000 0x0000000000000000
0x7fffffffce70: 0x0000000000000000 0x0000000000000000
0x7fffffffce80: 0x0000000000000000 0x0000000000000000
0x7fffffffce90: 0x0000000000000000 0x0000000000000000
0x7fffffffcea0: 0x0000000000000000 0x0000000000000000
0x7fffffffceb0: 0x0000000000000000 0x0000000000000000
0x7fffffffcec0: 0x0000000000000000 0x0000000000000000
0x7fffffffced0: 0x0000000000000000 0x0000000000000000
0x7fffffffcee0: 0x000000000000000a 0x00007ffff7fcf2d8
0x7fffffffcef0: 0x00007ffff7ffe700 0x00007fffffffcf88
0x7fffffffcf00: 0x00007fffffffcf84 0x00007fffffffcf01
0x7fffffffcf10: 0x00007ffff7ffd988 0x0000000000000000
0x7fffffffcf20: 0x00007ffff7fcf2d8 0x00007ffff7fcf1b8
0x7fffffffcf30: 0x00007ffff7f68a83 0x000000006562b026
0x7fffffffcf40: 0x0000000000000002 0x800000000000000e
0x7fffffffcf50: 0x0000000000000000 0x0000000000000000
0x7fffffffcf60: 0x0000000000000000 0x0000000000000000
0x7fffffffcf70: 0x0000000000000000 0x0000000000000000
0x7fffffffcf80: 0x0000000000000000 0x0000000000000000
0x7fffffffcf90: 0x0000000000000000 0x000000006562b026
0x7fffffffcfa0: 0x00007ffff7ffea98 0x66666637f7f68a83
0x7fffffffcfb0: 0x3466306466666666 0x74f98aa9ad07e700
0x7fffffffcfc0: 0x00007fffffffd050 0x0000000000000000
0x7fffffffcfd0: 0x0000000000401040 0x00007fffffffd1e0
0x7fffffffcfe0: 0x0000000000000000 0x0000000000000000
0x7fffffffcff0: 0x00007fffffffd100 0x00007ffff7e33d5f
0x7fffffffd000: 0x0000003000000008 0x00007fffffffd0e0
0x7fffffffd010: 0x00007fffffffd020 0x74f98aa9ad07e700
0x7fffffffd020: 0x0000000000000000 0x0000000000000001 <-- first parameter
0x7fffffffd030: 0x0000000000000002 0x0000000000000003 <-- second, third param
0x7fffffffd040: 0x0000000000000004 0x0000000000000005 <-- fourth, and fifth
0x7fffffffd050: 0x00007fffffffd100 0x0000000000401040
0x7fffffffd060: 0x0000000000000000 0x0000000000000000
0x7fffffffd070: 0x0000000000000000 0x0000000000000000
0x7fffffffd080: 0x0000000000000000 0x0000000000000000
0x7fffffffd090: 0x0000000000400040 0x0000000000f0b5ff
0x7fffffffd0a0: 0x00000000000000c2 0x00007fffffffd0d7
0x7fffffffd0b0: 0x00007fffffffd0d6 0x00007ffff7e86545
0x7fffffffd0c0: 0x0000000000000000 0x00007ffff7ffe150
0x7fffffffd0d0: 0x0000000000000000 0x0000000000401184
0x7fffffffd0e0: 0x00007fffffffd1e8 0x0000000100401040
0x7fffffffd0f0: 0x00000000ffffd1e0 0x00007fffffffd0f4 <-- magic key
0x7fffffffd100: 0x00000000004011c0 0x00007ffff7e031a3
0x7fffffffd110: 0x0000000000000000 0x00007fffffffd1e8
0x7fffffffd120: 0x0000000100040000 0x0000000000401126
0x7fffffffd130: 0x0000000000000000 0x6c8e6e6ed3005745
0x7fffffffd140: 0x0000000000401040 0x00007fffffffd1e0
0x7fffffffd150: 0x0000000000000000 0x0000000000000000
0x7fffffffd160: 0x9371911152a05745 0x9371812e922e5745
0x7fffffffd170: 0x0000000000000000 0x0000000000000000
0x7fffffffd180: 0x0000000000000000 0x00007fffffffd1f8
0x7fffffffd190: 0x00007ffff7ffe150 0x00007ffff7fe2031
0x7fffffffd1a0: 0x0000000000000000 0x0000000000000000
0x7fffffffd1b0: 0x0000000000401040 0x00007fffffffd1e0
0x7fffffffd1c0: 0x0000000000000000 0x000000000040106e
0x7fffffffd1d0: 0x00007fffffffd1d8 0x00007ffff7ffdfa0
0x7fffffffd1e0: 0x0000000000000001 0x00007fffffffd5b1
0x7fffffffd1f0: 0x0000000000000000 0x00007fffffffd5f0
0x7fffffffd200: 0x00007fffffffd604 0x00007fffffffd63a
0x7fffffffd210: 0x00007fffffffd651 0x00007fffffffd670
0x7fffffffd220: 0x00007fffffffd685 0x00007fffffffd69f
0x7fffffffd230: 0x00007fffffffd6c9 0x00007fffffffd765
0x7fffffffd240: 0x00007fffffffde60 0x00007fffffffdeac
0x7fffffffd250: 0x00007fffffffdf28 0x00007fffffffdf3d
0x7fffffffd260: 0x00007fffffffdf51 0x00007fffffffdf69
0x7fffffffd270: 0x00007fffffffdf88 0x00007fffffffdf99
0x7fffffffd280: 0x00007fffffffdfa7 0x00007fffffffdfd6
0x7fffffffd290: 0x00007fffffffe01a 0x00007fffffffe056
0x7fffffffd2a0: 0x00007fffffffe07f 0x00007fffffffe0a1
0x7fffffffd2b0: 0x00007fffffffe0af 0x00007fffffffe0ca
0x7fffffffd2c0: 0x00007fffffffe0de 0x00007fffffffe0ee
0x7fffffffd2d0: 0x00007fffffffe0fe 0x00007fffffffe112
0x7fffffffd2e0: 0x00007fffffffe13f 0x00007fffffffe175
0x7fffffffd2f0: 0x00007fffffffe18d 0x00007fffffffe1a4
0x7fffffffd300: 0x00007fffffffe1b3 0x00007fffffffe1d2
0x7fffffffd310: 0x00007fffffffe1e9 0x00007fffffffe216
0x7fffffffd320: 0x00007fffffffe223 0x00007fffffffe23c
0x7fffffffd330: 0x00007fffffffe29d 0x00007fffffffe2c0
0x7fffffffd340: 0x00007fffffffe2c8 0x00007fffffffe301
0x7fffffffd350: 0x00007fffffffe31b 0x00007fffffffe392
0x7fffffffd360: 0x00007fffffffe3aa 0x00007fffffffe3b5
0x7fffffffd370: 0x00007fffffffe3e6 0x00007fffffffe3fe
0x7fffffffd380: 0x00007fffffffe41f 0x00007fffffffe430
0x7fffffffd390: 0x00007fffffffe6b5 0x00007fffffffe6c9
0x7fffffffd3a0: 0x00007fffffffe717 0x00007fffffffeb5b
0x7fffffffd3b0: 0x00007fffffffeb99 0x00007fffffffebb0
0x7fffffffd3c0: 0x00007fffffffebcf 0x00007fffffffebf3
0x7fffffffd3d0: 0x00007fffffffec0b 0x00007fffffffec22
0x7fffffffd3e0: 0x00007fffffffec49 0x00007fffffffec63

(lldb) memory read --force -f x -c 500 -s 8 $rsp
0x7fffffffca90: 0x0000000000000000 0x0000000000000010
0x7fffffffcaa0: 0x0000000000000001 0x0000000000000000
0x7fffffffcab0: 0x0000000000000000 0x0000000000000000
0x7fffffffcac0: 0xffffffffffffffff 0x0000000100000001
0x7fffffffcad0: 0x00007fff00000000 0x00007fff00000010
0x7fffffffcae0: 0x00007fff00000000 0x00007fff00000012
0x7fffffffcaf0: 0x00007fff0000000c 0x000000000000000c
0x7fffffffcb00: 0x000000000000001e 0x0000000000000000
0x7fffffffcb10: 0x00007ffff7f9f700 0x0000000000000d68
0x7fffffffcb20: 0x0000000000402020 0x0000000000000000
0x7fffffffcb30: 0x0000000000400393 0x0000000000402023
0x7fffffffcb40: 0x000000000055acae 0x00007fffffffcb84
0x7fffffffcb50: 0x00007ffff7fa5520 0x00007fffffffcc50
0x7fffffffcb60: 0x0000000000400340 0x00007fffffffcc40
0x7fffffffcb70: 0x0000000000000003 0x00007ffff7fdbf7c
0x7fffffffcb80: 0x00007ffff7e35070 0x00007ffff7f9f500
0x7fffffffcb90: 0x00007ffff7fa5000 0x00000000156b2bb8
0x7fffffffcba0: 0x00007ffff7ffe4b8 0x0000003000000008
0x7fffffffcbb0: 0x00007fffffffd0e0 0x00007fffffffd020
0x7fffffffcbc0: 0x00007fffffffcc50 0x00007ffff7fdccc1
0x7fffffffcbd0: 0x0000000000000001 0x00007ffff7fa5570
0x7fffffffcbe0: 0x0000000000000001 0x0000000000000000
0x7fffffffcbf0: 0x0000000000000001 0x00007ffff7ffe150
0x7fffffffcc00: 0x00007ffff7fd192f 0x00007ffff7fa5570
0x7fffffffcc10: 0x00007ffff7ffe150 0x00007ffff7ffe4b8
0x7fffffffcc20: 0x0000000000000000 0x00007fffffffcd20
0x7fffffffcc30: 0x00007ffff7fd15a0 0x00007fff00000001
0x7fffffffcc40: 0x00000000ffffffff 0x0000000000000000
0x7fffffffcc50: 0x00007ffff7de7110 0x00007ffff7fa5000
0x7fffffffcc60: 0x0000000000000000 0x000000007c96f087
0x7fffffffcc70: 0x00007ffff7ffe4b8 0x00007ffff7fd192f
0x7fffffffcc80: 0x00007fffffffce38 0x00007fffffffcd10
0x7fffffffcc90: 0x00007fffffffcd20 0x0000000000404018
0x7fffffffcca0: 0x00007fffffffd100 0x0000000000401040
0x7fffffffccb0: 0x00007fffffffd1e0 0x0000000000000000
0x7fffffffccc0: 0x0000000000000000 0x00007ffff7fe16c7
0x7fffffffccd0: 0x0000000000000001 0x0000000000000000
0x7fffffffcce0: 0x00007ffff7ffd988 0x00007ffff7de7110
0x7fffffffccf0: 0x00007fffffffd0c0 0x00007ffff7fe878e
0x7fffffffcd00: 0x0000000000000000 0x00007ffff7f9e578
0x7fffffffcd10: 0x00007fffffffd1f8 0x00007fffffffd0f4
0x7fffffffcd20: 0x0000000000402010 0x0000000000000000
0x7fffffffcd30: 0x00007ffff7fe2100 0x0000000000000000
0x7fffffffcd40: 0x0000000000000000 0x00007ffff7fcf1e8
0x7fffffffcd50: 0x0000002000000000 0x0000ffff00001f80
0x7fffffffcd60: 0x0000000000000000 0x00007ffff7fd2000
0x7fffffffcd70: 0x00007fffffffceb0 0x0000000000000007
0x7fffffffcd80: 0x0000000900000007 0x00007ffff7fd15a0
0x7fffffffcd90: 0x00007ffff7ffd988 0x00007ffff7fde1c8
0x7fffffffcda0: 0x0000000000000000 0x00007ffff7fdefe8
0x7fffffffcdb0: 0x00007fffffffce00 0x00007ffff7df8b18
0x7fffffffcdc0: 0x0000000000004673 0x0000000000000000
0x7fffffffcdd0: 0x00007fffffffce80 0x0000000000000000
0x7fffffffcde0: 0x0000000000000000 0x0000000000000000
0x7fffffffcdf0: 0x766f2f7374696f6c 0x0065746972777265
0x7fffffffce00: 0x0000000000000000 0xff00000000000000
0x7fffffffce10: 0x0000ff0000000000 0x0000000000000000
0x7fffffffce20: 0x2f2f2f2f2f2f2f2f 0x2f2f2f2f2f2f2f2f
0x7fffffffce30: 0x0000000000000000 0x0000000000000000
0x7fffffffce40: 0x0000000000000000 0x0000000000000000
0x7fffffffce50: 0x0000000000000000 0x0000000000000000
0x7fffffffce60: 0x0000000000000000 0x0000000000000000
0x7fffffffce70: 0x0000000000000000 0x0000000000000000
0x7fffffffce80: 0x0000000000000000 0x0000000000000000
0x7fffffffce90: 0x0000000000000000 0x0000000000000000
0x7fffffffcea0: 0x0000000000000000 0x0000000000000000
0x7fffffffceb0: 0x0000000000000000 0x0000000000000000
0x7fffffffcec0: 0x0000000000000000 0x0000000000000000
0x7fffffffced0: 0x0000000000000000 0x0000000000000000
0x7fffffffcee0: 0x000000000000000a 0x00007ffff7fcf2d8
0x7fffffffcef0: 0x00007ffff7ffe700 0x00007fffffffcf88
0x7fffffffcf00: 0x00007fffffffcf84 0x00007fffffffcf01
0x7fffffffcf10: 0x00007ffff7ffd988 0x0000000000000000
0x7fffffffcf20: 0x00007ffff7fcf2d8 0x00007ffff7fcf1b8
0x7fffffffcf30: 0x00007ffff7f68a83 0x000000006562b026
0x7fffffffcf40: 0x0000000000000002 0x800000000000000e
0x7fffffffcf50: 0x0000000000000000 0x0000000000000000
0x7fffffffcf60: 0x0000000000000000 0x0000000000000000
0x7fffffffcf70: 0x0000000000000000 0x0000000000000000
0x7fffffffcf80: 0x0000000000000000 0x0000000000000000
0x7fffffffcf90: 0x0000000000000000 0x000000006562b026
0x7fffffffcfa0: 0x00007ffff7ffea98 0x66666637f7f68a83
0x7fffffffcfb0: 0x3466306466666666 0x972f1cdd42f42d00
0x7fffffffcfc0: 0x00007fffffffd050 0x0000000000000000
0x7fffffffcfd0: 0x0000000000401040 0x00007fffffffd1e0
0x7fffffffcfe0: 0x0000000000000000 0x0000000000000000
0x7fffffffcff0: 0x00007fffffffd100 0x00007ffff7e33d5f
0x7fffffffd000: 0x0000003000000008 0x00007fffffffd0e0
0x7fffffffd010: 0x00007fffffffd020 0x972f1cdd42f42d00
0x7fffffffd020: 0x0000000000000000 0x0000000000000001
0x7fffffffd030: 0x0000000000000002 0x0000000000000003
0x7fffffffd040: 0x0000000000000004 0x0000000000000005
0x7fffffffd050: 0x00007fffffffd100 0x0000000000401040
0x7fffffffd060: 0x0000000000000000 0x0000000000000000
0x7fffffffd070: 0x0000000000000000 0x0000000000000000
0x7fffffffd080: 0x0000000000000000 0x0000000000000000
0x7fffffffd090: 0x0000000000400040 0x0000000000f0b5ff
0x7fffffffd0a0: 0x00000000000000c2 0x00007fffffffd0d7
0x7fffffffd0b0: 0x00007fffffffd0d6 0x00007ffff7e86545
0x7fffffffd0c0: 0x0000000000000000 0x00007ffff7ffe150
0x7fffffffd0d0: 0x0000000000000000 0x0000000000401184

0x7fffffffd0e0: 0x00007fffffffd1e8 0x0000000100401040 <-- first stack variables in output. So rsp must point to
0x7fffffffd0f0: 0x00000000ffffd1e0 0x00007fffffffd0f4
0x7fffffffd100: 0x00000000004011c0 0x00007ffff7e031a3
0x7fffffffd110: 0x0000000000000000 0x00007fffffffd1e8
0x7fffffffd120: 0x0000000100040000 0x0000000000401126
0x7fffffffd130: 0x0000000000000000 0x96ea33346081548c
0x7fffffffd140: 0x0000000000401040 0x00007fffffffd1e0
0x7fffffffd150: 0x0000000000000000 0x0000000000000000
0x7fffffffd160: 0x6915cc4be121548c 0x6915dc7421af548c
0x7fffffffd170: 0x0000000000000000 0x0000000000000000
0x7fffffffd180: 0x0000000000000000 0x00007fffffffd1f8
0x7fffffffd190: 0x00007ffff7ffe150 0x00007ffff7fe2031
0x7fffffffd1a0: 0x0000000000000000 0x0000000000000000
0x7fffffffd1b0: 0x0000000000401040 0x00007fffffffd1e0
0x7fffffffd1c0: 0x0000000000000000 0x000000000040106e
0x7fffffffd1d0: 0x00007fffffffd1d8 0x00007ffff7ffdfa0
0x7fffffffd1e0: 0x0000000000000001 0x00007fffffffd5b1
0x7fffffffd1f0: 0x0000000000000000 0x00007fffffffd5f0
0x7fffffffd200: 0x00007fffffffd604 0x00007fffffffd63a
0x7fffffffd210: 0x00007fffffffd651 0x00007fffffffd670
0x7fffffffd220: 0x00007fffffffd685 0x00007fffffffd69f
0x7fffffffd230: 0x00007fffffffd6c9 0x00007fffffffd765
0x7fffffffd240: 0x00007fffffffde60 0x00007fffffffdeac
0x7fffffffd250: 0x00007fffffffdf28 0x00007fffffffdf3d
0x7fffffffd260: 0x00007fffffffdf51 0x00007fffffffdf69
0x7fffffffd270: 0x00007fffffffdf88 0x00007fffffffdf99
0x7fffffffd280: 0x00007fffffffdfa7 0x00007fffffffdfd6
0x7fffffffd290: 0x00007fffffffe01a 0x00007fffffffe056
0x7fffffffd2a0: 0x00007fffffffe07f 0x00007fffffffe0a1
0x7fffffffd2b0: 0x00007fffffffe0af 0x00007fffffffe0ca
0x7fffffffd2c0: 0x00007fffffffe0de 0x00007fffffffe0ee
0x7fffffffd2d0: 0x00007fffffffe0fe 0x00007fffffffe112
0x7fffffffd2e0: 0x00007fffffffe13f 0x00007fffffffe175
0x7fffffffd2f0: 0x00007fffffffe18d 0x00007fffffffe1a4
0x7fffffffd300: 0x00007fffffffe1b3 0x00007fffffffe1d2
0x7fffffffd310: 0x00007fffffffe1e9 0x00007fffffffe216
0x7fffffffd320: 0x00007fffffffe223 0x00007fffffffe23c
0x7fffffffd330: 0x00007fffffffe29d 0x00007fffffffe2c0
0x7fffffffd340: 0x00007fffffffe2c8 0x00007fffffffe301
0x7fffffffd350: 0x00007fffffffe31b 0x00007fffffffe392
0x7fffffffd360: 0x00007fffffffe3aa 0x00007fffffffe3b5
0x7fffffffd370: 0x00007fffffffe3e6 0x00007fffffffe3fe
0x7fffffffd380: 0x00007fffffffe41f 0x00007fffffffe430
0x7fffffffd390: 0x00007fffffffe6b5 0x00007fffffffe6c9
0x7fffffffd3a0: 0x00007fffffffe717 0x00007fffffffeb5b
0x7fffffffd3b0: 0x00007fffffffeb99 0x00007fffffffebb0
0x7fffffffd3c0: 0x00007fffffffebcf 0x00007fffffffebf3
0x7fffffffd3d0: 0x00007fffffffec0b 0x00007fffffffec22
0x7fffffffd3e0: 0x00007fffffffec49 0x00007fffffffec63
0x7fffffffd3f0: 0x00007fffffffec7d 0x00007fffffffecb2
0x7fffffffd400: 0x00007fffffffeeb9 0x00007fffffffeec9
0x7fffffffd410: 0x00007fffffffeee7 0x00007fffffffeef8
0x7fffffffd420: 0x00007fffffffef1e 0x00007fffffffef35
0x7fffffffd430: 0x00007fffffffef7a 0x00007fffffffef91
0x7fffffffd440: 0x00007fffffffefa7 0x0000000000000000
0x7fffffffd450: 0x0000000000000021 0x00007ffff7fcf000
0x7fffffffd460: 0x0000000000000010 0x00000000bfebfbff
0x7fffffffd470: 0x0000000000000006 0x0000000000001000
0x7fffffffd480: 0x0000000000000011 0x0000000000000064
0x7fffffffd490: 0x0000000000000003 0x0000000000400040
0x7fffffffd4a0: 0x0000000000000004 0x0000000000000038
0x7fffffffd4b0: 0x0000000000000005 0x000000000000000b
0x7fffffffd4c0: 0x0000000000000007 0x00007ffff7fd1000
0x7fffffffd4d0: 0x0000000000000008 0x0000000000000000
0x7fffffffd4e0: 0x0000000000000009 0x0000000000401040
0x7fffffffd4f0: 0x000000000000000b 0x00000000000003e8
0x7fffffffd500: 0x000000000000000c 0x00000000000003e8
0x7fffffffd510: 0x000000000000000d 0x00000000000003e8
0x7fffffffd520: 0x000000000000000e 0x00000000000003e8
0x7fffffffd530: 0x0000000000000017 0x0000000000000000
0x7fffffffd540: 0x0000000000000019 0x00007fffffffd599
0x7fffffffd550: 0x000000000000001a 0x0000000000000000
0x7fffffffd560: 0x000000000000001f 0x00007fffffffefb9
0x7fffffffd570: 0x000000000000000f 0x00007fffffffd5a9
0x7fffffffd580: 0x0000000000000000 0x0000000000000000
0x7fffffffd590: 0x0000000000000000 0x2f1cdd42f42d6d00
0x7fffffffd5a0: 0x464b7519da218097 0x0034365f363878aa
0x7fffffffd5b0: 0x642f656d6f682f00 0x7665626c65696e61
0x7fffffffd5c0: 0x6f772f7375696e65 0x72756365732f6b72
0x7fffffffd5d0: 0x7261656c2f797469 0x7078652d676e696e
0x7fffffffd5e0: 0x766f2f7374696f6c 0x0065746972777265
0x7fffffffd5f0: 0x6e61643d52455355 0x6e657665626c6569
0x7fffffffd600: 0x5455415800737569 0x2f3d595449524f48
0x7fffffffd610: 0x726573752f6e7572 0x6d2e2f303030312f
0x7fffffffd620: 0x77582d7265747475 0x7561646e616c7961
0x7fffffffd630: 0x543042305a2e6874 0x4d414e474f4c0030
0x7fffffffd640: 0x6c65696e61643d45 0x7375696e65766562
0x7fffffffd650: 0x4e55525f47445800 0x5249445f454d4954
0x7fffffffd660: 0x73752f6e75722f3d 0x00303030312f7265
0x7fffffffd670: 0x52455041505f434c 0x552e53555f6e653d
0x7fffffffd680: 0x4d4f4800382d4654 0x2f656d6f682f3d45
0x7fffffffd690: 0x65626c65696e6164 0x4f007375696e6576
0x7fffffffd6a0: 0x682f3d445750444c 0x696e61642f656d6f
0x7fffffffd6b0: 0x696e657665626c65 0x2f6b726f772f7375
0x7fffffffd6c0: 0x7974697275636573 0x5441445f47445800
0x7fffffffd6d0: 0x2f3d535249445f41 0x6e61642f656d6f68
0x7fffffffd6e0: 0x6e657665626c6569 0x636f6c2e2f737569
0x7fffffffd6f0: 0x65726168732f6c61 0x6b617074616c662f
0x7fffffffd700: 0x7374726f7078652f 0x3a2f65726168732f
0x7fffffffd710: 0x62696c2f7261762f 0x6b617074616c662f
0x7fffffffd720: 0x7374726f7078652f 0x3a2f65726168732f
0x7fffffffd730: 0x636f6c2f7273752f 0x65726168732f6c61
0x7fffffffd740: 0x732f7273752f3a2f 0x762f3a2f65726168
0x7fffffffd750: 0x732f62696c2f7261 0x7365642f6470616e
0x7fffffffd760: 0x5f534c00706f746b 0x723d53524f4c4f43
0x7fffffffd770: 0x333d69643a303d73 0x6c3a33333b353b38
0x7fffffffd780: 0x353b353b38333d6e 0x3a30303d686d3a31
0x7fffffffd790: 0x38333b30343d6970 0x6f733a31313b353b
0x7fffffffd7a0: 0x33313b353b38333d 0x353b38333d6f643a
0x7fffffffd7b0: 0x38343d64623a353b 0x333b3233323b353b
0x7fffffffd7c0: 0x633a31313b353b38 0x323b353b38343d64
0x7fffffffd7d0: 0x3b353b38333b3233 0x3b38343d726f3a33
0x7fffffffd7e0: 0x38333b3233323b35 0x3d696d3a393b353b
0x7fffffffd7f0: 0x31343b37333b3130 0x353b38343d75733a
0x7fffffffd800: 0x3b38333b3639313b 0x3d67733a35313b35
0x7fffffffd810: 0x3b31313b353b3834 0x3a36313b353b3833
0x7fffffffd820: 0x3b353b38343d6163 0x353b38333b363931
0x7fffffffd830: 0x3d77743a3632323b 0x3b30313b353b3834
0x7fffffffd840: 0x3a36313b353b3833 0x3b353b38343d776f
0x7fffffffd850: 0x3b353b38333b3031 0x38343d74733a3132
0x7fffffffd860: 0x38333b31323b353b 0x78653a35313b353b
0x7fffffffd870: 0x30343b353b38333d 0x333d7261742e2a3a
0x7fffffffd880: 0x2e2a3a393b353b38 0x353b38333d7a6774
0x7fffffffd890: 0x6372612e2a3a393b 0x3a393b353b38333d
0x7fffffffd8a0: 0x38333d6a72612e2a 0x742e2a3a393b353b
0x7fffffffd8b0: 0x3b353b38333d7a61 0x3d61686c2e2a3a39
0x7fffffffd8c0: 0x2a3a393b353b3833 0x3b38333d347a6c2e
0x7fffffffd8d0: 0x7a6c2e2a3a393b35 0x393b353b38333d68
0x7fffffffd8e0: 0x3d616d7a6c2e2a3a 0x2a3a393b353b3833
0x7fffffffd8f0: 0x3b38333d7a6c742e 0x78742e2a3a393b35
0x7fffffffd900: 0x393b353b38333d7a 0x333d6f7a742e2a3a
0x7fffffffd910: 0x2e2a3a393b353b38 0x353b38333d7a3774
0x7fffffffd920: 0x70697a2e2a3a393b 0x3a393b353b38333d
0x7fffffffd930: 0x353b38333d7a2e2a 0x3d7a642e2a3a393b
0x7fffffffd940: 0x2a3a393b353b3833 0x353b38333d7a672e
0x7fffffffd950: 0x7a726c2e2a3a393b 0x3a393b353b38333d
0x7fffffffd960: 0x3b38333d7a6c2e2a 0x7a6c2e2a3a393b35
0x7fffffffd970: 0x393b353b38333d6f 0x38333d7a782e2a3a
0x7fffffffd980: 0x7a2e2a3a393b353b 0x3b353b38333d7473
0x7fffffffd990: 0x74737a742e2a3a39 0x3a393b353b38333d
0x7fffffffd9a0: 0x38333d327a622e2a 0x622e2a3a393b353b
0x7fffffffd9b0: 0x393b353b38333d7a 0x333d7a62742e2a3a
0x7fffffffd9c0: 0x2e2a3a393b353b38 0x3b38333d327a6274
0x7fffffffd9d0: 0x7a742e2a3a393b35 0x3a393b353b38333d
0x7fffffffd9e0: 0x38333d6265642e2a 0x722e2a3a393b353b
0x7fffffffd9f0: 0x3b353b38333d6d70 0x3d72616a2e2a3a39
0x7fffffffda00: 0x2a3a393b353b3833 0x3b38333d7261772e
0x7fffffffda10: 0x61652e2a3a393b35 0x393b353b38333d72
0x7fffffffda20: 0x333d7261732e2a3a 0x2e2a3a393b353b38


### Stack Smashing Protection (SSP)
Is a compiler feature that help detects stack buffer overruns by adding a
secret value to the stack and then comparing this value before returning. If
this value was overwritten then a function will be called that will terminate
the process.

```console
libc.so.6`.annobin_printf.c:
    0x7ffff7e33cb0 <+0>:   endbr64 
    0x7ffff7e33cb4 <+4>:   sub    rsp, 0xd8
    0x7ffff7e33cbb <+11>:  mov    r10, rdi
    0x7ffff7e33cbe <+14>:  mov    qword ptr [rsp + 0x28], rsi
    0x7ffff7e33cc3 <+19>:  mov    qword ptr [rsp + 0x30], rdx
    0x7ffff7e33cc8 <+24>:  mov    qword ptr [rsp + 0x38], rcx
    0x7ffff7e33ccd <+29>:  mov    qword ptr [rsp + 0x40], r8
    0x7ffff7e33cd2 <+34>:  mov    qword ptr [rsp + 0x48], r9
    0x7ffff7e33cd7 <+39>:  test   al, al
    0x7ffff7e33cd9 <+41>:  je     0x7ffff7e33d12            ; <+98>
    0x7ffff7e33cdb <+43>:  movaps xmmword ptr [rsp + 0x50], xmm0
    0x7ffff7e33ce0 <+48>:  movaps xmmword ptr [rsp + 0x60], xmm1
    0x7ffff7e33ce5 <+53>:  movaps xmmword ptr [rsp + 0x70], xmm2
    0x7ffff7e33cea <+58>:  movaps xmmword ptr [rsp + 0x80], xmm3
    0x7ffff7e33cf2 <+66>:  movaps xmmword ptr [rsp + 0x90], xmm4
    0x7ffff7e33cfa <+74>:  movaps xmmword ptr [rsp + 0xa0], xmm5
    0x7ffff7e33d02 <+82>:  movaps xmmword ptr [rsp + 0xb0], xmm6
    0x7ffff7e33d0a <+90>:  movaps xmmword ptr [rsp + 0xc0], xmm7

    0x7ffff7e33d12 <+98>:  mov    rax, qword ptr fs:[0x28]
    ...

    0x7ffff7e33d5f <+175>: mov    rcx, qword ptr [rsp + 0x18]
    0x7ffff7e33d64 <+180>: xor    rcx, qword ptr fs:[0x28]
    0x7ffff7e33d6d <+189>: jne    0x7ffff7e33d77            ; <+199>
    0x7ffff7e33d6f <+191>: add    rsp, 0xd8
    0x7ffff7e33d76 <+198>: ret    
    0x7ffff7e33d77 <+199>: call   0x7ffff7eed640            ; .annobin_stack_chk_fail.c
```
`__stack_chk_fail` -- terminate a function in case of stack overflow


### Passing input from file to process
```console
(lldb) settings set target.input-path in.txt
```

### shell code example
I've been trying to get [formatstring](../src/formatstring.c) working and it 
does in a way. What I've been able to do is to add have the return address
overwritten.

The assembly code can be found in [exit.s](../src/exit.s) and compiled and
then the opcodes are take and verified by [check_opcode.c](../src/check_opcode.c).

Currently, the returns 4 which we can see in the debugger:
```console
Process 3918047 launched: '/home/danielbevenius/work/security/learning-exploits/formatstring' (x86_64)
Format String exploration
aaaaaaaaaaaaaaaaaaaaaaa 0x000000004052a0 0x00000000000009 0x007ffff7ece4a7 0x0000000000001a 0x00000000000040 0x007fffffffd1d8 0x00000100f0b5ff 0x000000000000c2 0x007fffffffd0c7 0x007fffffffd0c6 0x007ffff7e86545            (nil) 0x0000000040127d
rip stack element: 0x007ffff7e86545
Process 3918047 exited with status = 4 (0x00000004)
```
When running this outside of the debugger we have to remember that execve will
be running the executable and it will not show the return value of 4.

So my first attempt was just to add an exit call to a process. What we really
want here is the start a shell using the injected opcodes.



